<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>32 String Matching - Introduction-To-Algorithms-Cpp-code</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/katex.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "32 String Matching";
    var mkdocs_page_input_path = "ch32\\readme.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-117404761-1', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Introduction-To-Algorithms-Cpp-code</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Preface</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Sort</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../sort/simple_sort/">simple_sort</a>
                </li>
                <li class="">
                    
    <a class="" href="../../sort/nlogn/">nlogn</a>
                </li>
                <li class="">
                    
    <a class="" href="../../sort/on/">True</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">I Foundations && II Sorting and Order Statistics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ch4/readme/">4 Divide-and-Conquer</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch9/readme/">9 Medians and Order Statistics</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">III Data Structures</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ch12/readme/">12 Binary Search Trees</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">IV Advanced Design and Analysis Techniques</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ch15/readme/">15 Dynamic Programming</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch16/readme/">16 Greedy Algorithms</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">V Advanced Data Structures</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ch21/readme/">21 Data Structures for Disjoint Sets</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">VI Graph Algorithms</span>
    <ul class="subnav">
                <li class="">
                    
    <span class="caption-text">22 Elementary Graph Algorithms</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../Graph/22.123/">22.1~3 Graph,breadth, Depth search</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Graph/22.4_DAG/">22.4 Topological sort</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../Graph/22.5_SCC/">22.5 Strongly connected components</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../Graph/23_MST/">23 Minimum Spanning Trees</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Graph/24_SSSP/">24 Single-Source Shortest Paths</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Graph/25_all_pairs_shortest_paths/">25 All-Pairs Shortest Paths</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">VII Selected Topics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../ch27/readme/">27 Multithreaded Algorithms</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch28/readme/">28 Matrix Operations</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch29/readme/">29 Linear Programming</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch30/readme/">30 Polynomials and the FFT</a>
                </li>
                <li class="">
                    
    <a class="" href="../../ch31/readme/">31 Number-Theoretic Algorithms</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">32 String Matching</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#321-the-naive-string-matching-algorithm">32.1 The naive string matching algorithm</a></li>
    

    <li class="toctree-l3"><a href="#322-the-rabin-karp-algorighm">32.2 The Rabin Karp algorighm</a></li>
    

    <li class="toctree-l3"><a href="#323-string-matching-with-finite-automata">32.3 String matching with finite automata</a></li>
    

    <li class="toctree-l3"><a href="#324-the-knuth-morris-pratt-algorithm">32.4 The Knuth-Morris-Pratt algorithm</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Introduction-To-Algorithms-Cpp-code</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>VII Selected Topics &raquo;</li>
        
      
    
    <li>32 String Matching</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="321-the-naive-string-matching-algorithm">32.1 The naive string matching algorithm</h1>
<p>m = T.length
n = P.length</p>
<p>$O((n-m+1)m)$
<pre class="codehilite"><code class="language-C++ linenums">void NAIVE_STRING_MATCHER(char* T, int m , char* P, int n )
{
    for (int s = 0; s &lt;= n - m; s++)
    {
        bool matching = true; // strcmp
        for (int i = 0; i &lt; m; i++)
        {
            if (T[i+s] != P[i])
            {
                matching = false;
            }
        }
        if (matching)
        {
            std::cout &lt;&lt; "Pattern occurs with shift" &lt;&lt; s &lt;&lt;'\n';
        }
    }
}</code></pre></p>
<h1 id="322-the-rabin-karp-algorighm">32.2 The Rabin Karp algorighm</h1>
<p>Preprocessing time : $O(m)$</p>
<p>Matching time $O((n-m+1)m)$
평균 O(m)</p>
<p>q = prime</p>
<p>d = sigma star</p>
<p>I'm setting d = 26 (only Letter case)</p>
<pre class="codehilite"><code class="language-C++ linenums">void RABIN_KARP_MATCHER(char T[], int n , char P[], int m, int d, int q)
{
    int h = MODULAR_EXPONENTIATION(d, n - 1, q);
    int p = 0;
    int t_0 = 0;
    for (int i = 0; i &lt; n; i++) //전처리
    {
        p = (d * p + (P[i]-'A')) % q;
        t_0 = (d * t_0 + (T[i]-'A')) % q;
    }
    for (int s = 0; s &lt;= m - n ; s++)
    {
        if (p == t_0)
        {
            bool matching = true; // strcmp
            for (int i = 0; i &lt; n; i++)
            {
                if (T[i + s] != P[i])
                {
                    matching = false;
                    break;
                }
            }
            if (matching)
            {
                std::cout &lt;&lt; "Pattern occurs with shift" &lt;&lt; s &lt;&lt; '\n';
            }
        }
        if (s &lt; m - n)
        {
            t_0 = ((d * (t_0 - (T[s]-'A') * h) + (T[s + n]-'A')) % q + q)%q;//음수가 나올수있기때문에 음수처리를 한다.
        }
    }
}

</code></pre>

<h1 id="323-string-matching-with-finite-automata">32.3 String matching with finite automata</h1>
<p>https://www.acmicpc.net/problem/1786</p>
<p>Preprocessing time : $O(m^3 <em>\Sigma)$
뒤의 kmp를 응용해서 해당 복잡도를 $O(m</em>\Sigma)$로 줄일 수 있다.</p>
<p>Matching time $O(n)$
<pre class="codehilite"><code class="language-C++ linenums">void FINITE_AUTOMATON_MATCHER(char T[], int n , std::vector&lt;std::vector&lt;int&gt;&gt; equation, int m )
{
    int q = 0;
    for (int i = 0; i &lt; n ; i++)
    {
        q = equation[q][T[i]-'A'];
        if (q == m)
        {
            std::cout &lt;&lt; "Pattern occurs with shift" &lt;&lt; i-m+1 &lt;&lt; '\n';
        }
    }
}</code></pre></p>
<pre class="codehilite"><code class="language-C++ linenums">std::vector&lt;std::vector&lt;int&gt;&gt; COMPUTE_TRANSITION_FUNCTION(char P[],int sigma, int m)//
{
    std::vector&lt;std::vector&lt;int&gt;&gt; transition_function;
    transition_function.resize(m+1);
    for (int i = 0; i &lt;= m; i++)
    {
        transition_function[i].resize(sigma,0);
    }
    for (int q = 0; q &lt;= m; q++)
    {
        for (char a = 0; a &lt; sigma; a++)
        {
            int k = (m+1&lt; q+2  ? m + 1: q+2);
            bool matching = true;
            do
            {
                k--;
                matching = true;
                if (k == 0)
                {
                    break;
                }
                if (P[k-1] != a+'A') // 접미사 매칭
                {
                    continue;
                }
                for(int i = 0; i &lt; k ; i++)
                {
                    if (k - 2 - i &lt; 0 || q - i &lt; 0)
                    {
                        matching = false;
                        break;
                    }
                    if (P[k - 1 - i] != P[q-i])
                    {
                        break;
                    }
                }
            } while (matching);
            transition_function[q][a] = k;
        }
    }
    return transition_function;
}</code></pre>

<h1 id="324-the-knuth-morris-pratt-algorithm">32.4 The Knuth-Morris-Pratt algorithm</h1>
<p>Preprocessing time : $O(m)$</p>
<p>Matching time $O(n)$</p>
<pre class="codehilite"><code class="language-C++ linenums">void KMP_MATCHER(char T[], int n, char P[], int m)
{
    std::vector&lt;int&gt; pi = COMPUTE_PREFIX_FUNCTION(P, m);
    int q = -1;
    for (int i = 0; i &lt; n; i++)
    {
        while (q &gt;= 0 &amp;&amp; P[q + 1] != T[i])
        {
            q = pi[q];
        }
        if (P[q + 1] == T[i])
        {
            q++;
        }
        if (q+1 == m)
        {
            std::cout &lt;&lt; "Pattern occurs with shift" &lt;&lt; i - m + 1 &lt;&lt; '\n';
            q = pi[q];
        }
    }
}</code></pre>

<pre class="codehilite"><code class="language-C++ linenums">std::vector&lt;int&gt; COMPUTE_PREFIX_FUNCTION(char P[], int m)
{
    std::vector&lt;int&gt; pi;
    pi.resize(m);
    pi[0] = -1;
    int k = -1; 
    for (int q = 1; q &lt; m; q++)
    {
        while (k &gt;= 0 &amp;&amp; P[k+1] != P[q])
        {
            k = pi[k];
        }
        if (P[k + 1] == P[q])
        {
            k++;
        }
        pi[q] = k;
    }
    return pi;
}</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../../ch31/readme/" class="btn btn-neutral" title="31 Number-Theoretic Algorithms"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../ch31/readme/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../js/katex.js" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
